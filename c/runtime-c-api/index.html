<!DOCTYPE html>
<html lang="en">
  <head>
    <title>wasmer-runtime-c-api: Wasmer Runtime C API</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="content-type" content="text/javascript; charset=utf-8" />
    <meta http-equiv="content-type" content="text/css; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0" />
    <meta name="generator" content="Doxygen 1.8.17"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="wasmer.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="top" role="header">
      <img alt="Wasmer's logo" src="logo.png" />
      <div>
        <h1>
        wasmer-runtime-c-api
        </h1>
        <br />
        <small>
          <a href="https://github.com/wasmerio/wasmer"><img src="https://img.shields.io/github/stars/wasmerio/wasmer?style=social" alt="Visit the repository" /></a>
          <a href="https://github.com/wasmerio/wasmer"><img src="https://img.shields.io/github/license/wasmerio/wasmer" alt="License" /></a>
          <a href="https://spectrum.chat/wasmer"><img src="https://withspectrum.github.io/badge/badge.svg" alt="Join the Wasmer Community"></a>
        </small>
      </div>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Wasmer Runtime C API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://github.com/wasmerio/wasmer">Wasmer</a> is a standalone <a href="https://webassembly.org/">WebAssembly</a> runtime, aiming to be fully compatible with WASI, Emscripten, Rust and Go. <a href="https://github.com/wasmerio/wasmer">Learn more</a>.</p>
<p>The <code>wasmer-runtime-c-api</code> crate exposes a C and a C++ API to interact with the Wasmer runtime. This document is the index of its auto-generated documentation.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Usage</h1>
<p>Since the Wasmer runtime is written in Rust, the C and C++ API are designed to work hand-in-hand with its shared library. The C and C++ header files, namely <a href="./wasmer_8h.html"><code>wasmer.h</code></a> and <a href="./wasmer_8hh.html"><code>wasmer.hh</code></a> are documented here. Their source code can be found in the source tree of this crate. They are automatically generated, and always up-to-date in this repository. The C and C++ header files along with the runtime shared libraries (<code>.so</code>, <code>.dylib</code>, <code>.dll</code>) can also be downloaded in the Wasmer <a href="https://github.com/wasmerio/wasmer/releases">release page</a>.</p>
<p>Here is a simple example to use the C API:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;../wasmer.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Read the Wasm file bytes.</span></div>
<div class="line">    FILE *file = fopen(<span class="stringliteral">&quot;sum.wasm&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">    fseek(file, 0, SEEK_END);</div>
<div class="line">    <span class="keywordtype">long</span> len = ftell(file);</div>
<div class="line">    uint8_t *bytes = malloc(len);</div>
<div class="line">    fseek(file, 0, SEEK_SET);</div>
<div class="line">    fread(bytes, 1, len, file);</div>
<div class="line">    fclose(file);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Prepare the imports.</span></div>
<div class="line">    <a class="code" href="structwasmer__import__t.html">wasmer_import_t</a> imports[] = {};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Instantiate!</span></div>
<div class="line">    <a class="code" href="structwasmer__instance__t.html">wasmer_instance_t</a> *instance = NULL;</div>
<div class="line">    <a class="code" href="wasmer_8h.html#ab3c4192a4579aa2510cbbfdb0a3d7847">wasmer_result_t</a> instantiation_result = <a class="code" href="wasmer_8h.html#a851ffc7c0de470300c66891f571878a5">wasmer_instantiate</a>(&amp;instance, bytes, len, imports, 0);</div>
<div class="line"> </div>
<div class="line">    assert(instantiation_result == WASMER_OK);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Let&#39;s call a function.</span></div>
<div class="line">    <span class="comment">// Start by preparing the arguments.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Value of argument #1 is `7i32`.</span></div>
<div class="line">    <a class="code" href="structwasmer__value__t.html">wasmer_value_t</a> argument_one;</div>
<div class="line">    argument_one.<a class="code" href="structwasmer__value__t.html#ade0da74bca0aa810f7f45069ff6e239d">tag</a> = <a class="code" href="wasmer_8h.html#ab59c1ddbf63e81d9a311722271a3bf79abd706ef1b12a0f58c838b4425a1de440">WASM_I32</a>;</div>
<div class="line">    argument_one.<a class="code" href="structwasmer__value__t.html#a8091c4a097af1f0040a32396be8c7af6">value</a>.<a class="code" href="unionwasmer__value.html#a2bdcc05e6d042bc646c1c3f1eee1756c">I32</a> = 7;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Value of argument #2 is `8i32`.</span></div>
<div class="line">    <a class="code" href="structwasmer__value__t.html">wasmer_value_t</a> argument_two;</div>
<div class="line">    argument_two.<a class="code" href="structwasmer__value__t.html#ade0da74bca0aa810f7f45069ff6e239d">tag</a> = <a class="code" href="wasmer_8h.html#ab59c1ddbf63e81d9a311722271a3bf79abd706ef1b12a0f58c838b4425a1de440">WASM_I32</a>;</div>
<div class="line">    argument_two.<a class="code" href="structwasmer__value__t.html#a8091c4a097af1f0040a32396be8c7af6">value</a>.<a class="code" href="unionwasmer__value.html#a2bdcc05e6d042bc646c1c3f1eee1756c">I32</a> = 8;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Prepare the arguments.</span></div>
<div class="line">    <a class="code" href="structwasmer__value__t.html">wasmer_value_t</a> arguments[] = {argument_one, argument_two};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Prepare the return value.</span></div>
<div class="line">    <a class="code" href="structwasmer__value__t.html">wasmer_value_t</a> result_one;</div>
<div class="line">    <a class="code" href="structwasmer__value__t.html">wasmer_value_t</a> results[] = {result_one};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Call the `sum` function with the prepared arguments and the return value.</span></div>
<div class="line">    <a class="code" href="wasmer_8h.html#ab3c4192a4579aa2510cbbfdb0a3d7847">wasmer_result_t</a> call_result = <a class="code" href="wasmer_8h.html#a05d595a60b647088d5e71f1d2a1fdc81">wasmer_instance_call</a>(instance, <span class="stringliteral">&quot;sum&quot;</span>, arguments, 2, results, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Let&#39;s display the result.</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Call result:  %d\n&quot;</span>, call_result);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Result: %d\n&quot;</span>, results[0].value.I32);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// `sum(7, 8) == 15`.</span></div>
<div class="line">    assert(results[0].value.I32 == 15);</div>
<div class="line">    assert(call_result == WASMER_OK);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="wasmer_8h.html#afab1426069281f315cc1d140c2b5d105">wasmer_instance_destroy</a>(instance);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Testing</h1>
<p>Tests are run using the release build of the library. If you make changes or compile with non-default features, please ensure you rebuild in release mode for the tests to see the changes.</p>
<p>The tests can be run via <code>cargo test</code>, such as:</p>
<div class="fragment"><div class="line">$ cargo test --release -- --nocapture</div>
</div><!-- fragment --><p>To run tests manually, enter the <code>lib/runtime-c-api/tests</code> directory and run the following commands:</p>
<div class="fragment"><div class="line">$ cmake .</div>
<div class="line">$ make</div>
<div class="line">$ make test</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3"></a>
License</h1>
<p>Wasmer is primarily distributed under the terms of the <a href="http://opensource.org/licenses/MIT">MIT license</a> (<a href="https://github.com/wasmerio/wasmer/blob/master/LICENSE">LICENSE</a>). </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="awasmer_8h_html_a851ffc7c0de470300c66891f571878a5"><div class="ttname"><a href="wasmer_8h.html#a851ffc7c0de470300c66891f571878a5">wasmer_instantiate</a></div><div class="ttdeci">wasmer_result_t wasmer_instantiate(wasmer_instance_t **instance, uint8_t *wasm_bytes, uint32_t wasm_bytes_len, wasmer_import_t *imports, int imports_len)</div></div>
<div class="ttc" id="astructwasmer__value__t_html"><div class="ttname"><a href="structwasmer__value__t.html">wasmer_value_t</a></div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00143">wasmer.h:143</a></div></div>
<div class="ttc" id="astructwasmer__import__t_html"><div class="ttname"><a href="structwasmer__import__t.html">wasmer_import_t</a></div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00201">wasmer.h:201</a></div></div>
<div class="ttc" id="awasmer_8h_html_ab3c4192a4579aa2510cbbfdb0a3d7847"><div class="ttname"><a href="wasmer_8h.html#ab3c4192a4579aa2510cbbfdb0a3d7847">wasmer_result_t</a></div><div class="ttdeci">wasmer_result_t</div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00076">wasmer.h:76</a></div></div>
<div class="ttc" id="astructwasmer__value__t_html_ade0da74bca0aa810f7f45069ff6e239d"><div class="ttname"><a href="structwasmer__value__t.html#ade0da74bca0aa810f7f45069ff6e239d">wasmer_value_t::tag</a></div><div class="ttdeci">wasmer_value_tag tag</div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00144">wasmer.h:144</a></div></div>
<div class="ttc" id="awasmer_8h_html_a05d595a60b647088d5e71f1d2a1fdc81"><div class="ttname"><a href="wasmer_8h.html#a05d595a60b647088d5e71f1d2a1fdc81">wasmer_instance_call</a></div><div class="ttdeci">wasmer_result_t wasmer_instance_call(wasmer_instance_t *instance, const char *name, const wasmer_value_t *params, uint32_t params_len, wasmer_value_t *results, uint32_t results_len)</div></div>
<div class="ttc" id="astructwasmer__instance__t_html"><div class="ttname"><a href="structwasmer__instance__t.html">wasmer_instance_t</a></div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00093">wasmer.h:93</a></div></div>
<div class="ttc" id="astructwasmer__value__t_html_a8091c4a097af1f0040a32396be8c7af6"><div class="ttname"><a href="structwasmer__value__t.html#a8091c4a097af1f0040a32396be8c7af6">wasmer_value_t::value</a></div><div class="ttdeci">wasmer_value value</div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00145">wasmer.h:145</a></div></div>
<div class="ttc" id="awasmer_8h_html_afab1426069281f315cc1d140c2b5d105"><div class="ttname"><a href="wasmer_8h.html#afab1426069281f315cc1d140c2b5d105">wasmer_instance_destroy</a></div><div class="ttdeci">void wasmer_instance_destroy(wasmer_instance_t *instance)</div></div>
<div class="ttc" id="aunionwasmer__value_html_a2bdcc05e6d042bc646c1c3f1eee1756c"><div class="ttname"><a href="unionwasmer__value.html#a2bdcc05e6d042bc646c1c3f1eee1756c">wasmer_value::I32</a></div><div class="ttdeci">int32_t I32</div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00137">wasmer.h:137</a></div></div>
<div class="ttc" id="awasmer_8h_html_ab59c1ddbf63e81d9a311722271a3bf79abd706ef1b12a0f58c838b4425a1de440"><div class="ttname"><a href="wasmer_8h.html#ab59c1ddbf63e81d9a311722271a3bf79abd706ef1b12a0f58c838b4425a1de440">wasmer_value_tag::WASM_I32</a></div><div class="ttdeci">@ WASM_I32</div><div class="ttdef"><b>Definition:</b> <a href="wasmer_8h_source.html#l00082">wasmer.h:82</a></div></div>

<div id="nav-path" class="navpath" role="footer">
  Generated by
  <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a>
  1.8.17
</div>
</body>
</html>
